<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SONTIL AI</title>
    
    <script src="https://pl28710734.effectivegatecpm.com/0e/56/5d/0e565d7c5c5ab381e354dd8283b27e86.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap');
        
        :root { --accent: #818cf8; --dark: #020617; }
        body { background-color: #343541; color: white; margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; }
        
        .hidden-section { display: none !important; }
        nav button.active { color: #60a5fa; border-bottom: 2px solid #60a5fa; }

        /* Video Section Specific Styles */
        #section-video { background: radial-gradient(circle at top right, #1e1b4b, #020617); }
        .canvas-container { 
            background: #000; position: relative; overflow: hidden; border-radius: 2rem; 
            border: 4px solid rgba(255, 255, 255, 0.1); box-shadow: 0 50px 100px -20px rgba(0,0,0,0.5); 
        }
        .mode-9-16 { width: 320px; aspect-ratio: 9 / 16; }
        .mode-16-9 { width: 100%; max-width: 640px; aspect-ratio: 16 / 9; }
        
        .glass-panel { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }
        
        #chat-box { height: calc(100vh - 180px); overflow-y: auto; padding: 20px; }
    </style>
</head>
<body>

    <nav class="sticky top-0 z-[100] bg-[#202123] border-b border-gray-700 px-6 py-4 flex justify-between items-center h-[64px]">
        <div class="flex items-center gap-2 cursor-pointer group" onclick="goHome()">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-bold text-white shadow-lg group-hover:bg-blue-500">S</div>
            <span class="font-bold text-xl tracking-tight">SONTIL AI</span>
        </div>
        <div class="flex gap-4 text-[10px] md:text-xs font-bold uppercase tracking-widest">
            <button onclick="showSection('chat')" id="nav-chat" class="active pb-1">Chat AI</button>
            <button onclick="showSection('video')" id="nav-video" class="text-gray-400 pb-1">Video Lirik</button>
            <button onclick="showSection('artikel')" id="nav-artikel" class="text-gray-400 pb-1">Artikel</button>
        </div>
    </nav>

    <section id="section-chat" class="p-4">
        <div id="chat-box" class="max-w-4xl mx-auto flex flex-col gap-4">
            <div class="bg-gray-700 p-4 rounded-xl max-w-[85%] border-l-4 border-blue-500 shadow-md">
                Selamat datang di <b>SONTIL AI</b>. Silakan gunakan menu <b>Video Lirik</b> untuk membuat konten musik.
            </div>
        </div>
        <div class="max-w-4xl mx-auto mt-4 flex gap-3">
            <input id="user-input" type="text" class="flex-1 p-4 rounded-xl bg-gray-700 border border-gray-600 outline-none focus:border-blue-500" placeholder="Tanya Sontil AI...">
            <button onclick="send()" class="bg-blue-600 px-6 py-2 rounded-xl font-bold">Kirim</button>
        </div>
    </section>

    <section id="section-video" class="hidden-section min-h-screen p-4 md:p-8">
        <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
            
            <div class="flex flex-col items-center gap-6 sticky top-24">
                <div class="flex bg-black/40 p-1 rounded-2xl mb-2">
                    <button onclick="setRatio('9:16')" id="ratio916" class="px-6 py-2 rounded-xl text-[10px] font-bold active bg-indigo-600">9:16</button>
                    <button onclick="setRatio('16:9')" id="ratio169" class="px-6 py-2 rounded-xl text-[10px] font-bold ml-1 text-gray-400">16:9</button>
                </div>

                <div id="container" class="canvas-container mode-9-16">
                    <canvas id="videoCanvas" width="720" height="1280" class="w-full h-full"></canvas>
                    <div id="loadingOverlay" class="hidden absolute inset-0 bg-black/90 flex flex-col items-center justify-center z-50">
                        <div class="w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
                        <p class="text-xs font-bold mt-4 tracking-widest text-indigo-400 uppercase">Mengekspor Video...</p>
                    </div>
                </div>

                <div class="w-full glass-panel p-6 rounded-[2rem] space-y-4">
                    <div class="flex items-center gap-4">
                        <button id="playBtn" class="w-14 h-14 bg-white text-black rounded-full flex items-center justify-center shadow-xl hover:scale-105 transition">
                            <svg id="playIcon" viewBox="0 0 24 24" width="28" height="28" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <div class="flex-1 bg-white/10 h-2 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full bg-indigo-500 w-0 transition-all"></div>
                        </div>
                    </div>
                    <button id="exportBtn" class="w-full bg-indigo-600 hover:bg-indigo-500 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition shadow-lg">UNDUH VIDEO (.WEBM)</button>
                </div>
            </div>

            <div class="glass-panel p-8 rounded-[2.5rem] space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">Judul Lagu</label>
                        <input type="text" id="songTitle" class="w-full bg-black/40 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-indigo-500" placeholder="Contoh: Sontil AI Theme">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">Nama Artis</label>
                        <input type="text" id="artistName" class="w-full bg-black/40 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-indigo-500" placeholder="Contoh: Sontil Team">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-4 border border-dashed border-white/10 rounded-2xl">
                        <label class="text-[10px] font-black text-indigo-400 uppercase block mb-2">Pilih MP3</label>
                        <input type="file" id="audioFile" accept="audio/*" class="text-xs w-full">
                    </div>
                    <div class="p-4 border border-dashed border-white/10 rounded-2xl">
                        <label class="text-[10px] font-black text-indigo-400 uppercase block mb-2">Pilih Cover</label>
                        <input type="file" id="coverFile" accept="image/*" class="text-xs w-full">
                    </div>
                </div>

                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label class="text-[10px] font-black text-indigo-400 uppercase tracking-widest">Sinkronisasi Lirik</label>
                        <span class="text-[9px] text-gray-500 uppercase">Format: [00:10.00] Teks</span>
                    </div>
                    <textarea id="syncMap" rows="12" class="w-full bg-black/60 border border-white/10 rounded-2xl p-4 text-[12px] font-mono text-indigo-200 outline-none focus:border-indigo-500 custom-scrollbar" placeholder="[00:01.00] Halo selamat datang&#10;[00:05.50] Di SONTIL AI Video Maker..."></textarea>
                </div>
            </div>

        </div>
    </section>

    <section id="section-artikel" class="hidden-section p-8 md:p-20 min-h-screen bg-[#1a1b1e]">
    <div class="max-w-4xl mx-auto">
        <article class="prose prose-invert lg:prose-xl">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-8 border-b border-gray-800 pb-6 text-blue-500 uppercase tracking-tighter">
                Evolusi Kecerdasan Buatan: Bagaimana SONTIL AI Menjadi Pionir Kreativitas Digital Masa Depan
            </h1>
            
            <div class="text-gray-300 leading-relaxed text-lg text-justify space-y-6">
                <p class="font-bold text-xl text-white italic">"Dunia tidak lagi sama sejak kehadiran Artificial Intelligence (AI)..."</p>
                
                <h2 class="text-2xl font-bold text-blue-400 mt-10">1. Mengenal SONTIL AI: Lebih Dari Sekadar Chatbot</h2>
                <p>Banyak orang mengira bahwa AI hanya terbatas pada kotak teks yang menjawab pertanyaan. Namun, SONTIL AI mendefinisikan ulang konsep tersebut...</p>

                <h2 class="text-2xl font-bold text-blue-400 mt-10">2. Kekuatan di Balik Layar: Google Gemini</h2>
                <p>Inti dari kecerdasan SONTIL AI adalah Gemini, model bahasa paling mumpuni yang pernah diciptakan oleh Google...</p>

                <h2 class="text-2xl font-bold text-blue-400 mt-10">3. Revolusi Kreatif: Fitur MP3 to Video Lirik</h2>
                <p>Salah satu fitur yang paling diminati dan menjadikan SONTIL AI unik adalah fitur MP3 TO VIDEO LIRIK. Di era dominasi konten video pendek seperti TikTok dan Reels...</p>

                <h2 class="text-2xl font-bold text-blue-400 mt-10">8. Penutup: Mari Tumbuh Bersama SONTIL AI</h2>
                <p>Dunia teknologi bergerak sangat cepat. Mereka yang tidak beradaptasi akan tertinggal. SONTIL AI hadir bukan untuk menggantikan peran manusia, melainkan untuk memperkuat potensi yang ada...</p>
            </div>
            
            <footer class="mt-20 pt-10 border-t border-gray-800 text-center">
                <p class="text-gray-500 font-bold uppercase tracking-widest text-xs">&copy; 2026 SONTIL AI | Seluruh Hak Cipta Dilindungi</p>
            </footer>
        </article>
    </div>
</section>

    <audio id="mainAudio" crossOrigin="anonymous"></audio>

    <script>
        // NAVIGATION LOGIC
        function showSection(type) {
            ['chat', 'video', 'artikel'].forEach(s => {
                document.getElementById('section-' + s).classList.add('hidden-section');
                document.getElementById('nav-' + s).classList.remove('active');
            });
            document.getElementById('section-' + type).classList.remove('hidden-section');
            document.getElementById('nav-' + type).classList.add('active');
            window.scrollTo(0,0);
        }
        function goHome() { showSection('chat'); }

        // CHAT LOGIC
        async function send() {
            const input = document.getElementById('user-input');
            const box = document.getElementById('chat-box');
            if(!input.value.trim()) return;
            const msg = input.value; input.value = '';
            box.innerHTML += `<div class="bg-blue-600 p-3 rounded-xl self-end ml-auto max-w-[85%] shadow-md text-sm">${msg}</div>`;
            try {
                const res = await fetch('/ask', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({message: msg}) });
                const data = await res.json();
                box.innerHTML += `<div class="bg-gray-700 p-4 rounded-xl max-w-[85%] border-l-4 border-blue-500 mt-2 text-sm shadow-md"><b>SONTIL AI:</b><div class="mt-2 text-gray-200">${marked.parse(data.reply)}</div></div>`;
                box.scrollTop = box.scrollHeight;
            } catch (e) { console.error(e); }
        }

        // VIDEO ENGINE LOGIC [Sesuai File Asli mp3 to video lirik.html]
        const canvas = document.getElementById('videoCanvas');
        const ctx = canvas.getContext('2d');
        const audio = document.getElementById('mainAudio');
        const syncMap = document.getElementById('syncMap');
        const playBtn = document.getElementById('playBtn');
        const exportBtn = document.getElementById('exportBtn');
        const songTitle = document.getElementById('songTitle');
        const artistName = document.getElementById('artistName');

        let lyrics = [], isPlaying = false, coverImg = null, blurImg = null, scrollY = 0;

        function setRatio(r) {
            const container = document.getElementById('container');
            if(r === '9:16') { container.className = "canvas-container mode-9-16"; canvas.width = 720; canvas.height = 1280; }
            else { container.className = "canvas-container mode-16-9"; canvas.width = 1280; canvas.height = 720; }
            document.getElementById('ratio916').className = "px-6 py-2 rounded-xl text-[10px] font-bold " + (r === '9:16' ? "bg-indigo-600 text-white" : "text-gray-400");
            document.getElementById('ratio169').className = "px-6 py-2 rounded-xl text-[10px] font-bold ml-1 " + (r === '16:9' ? "bg-indigo-600 text-white" : "text-gray-400");
            draw();
        }

        function draw() {
            const W = canvas.width, H = canvas.height;
            ctx.fillStyle = '#020617'; ctx.fillRect(0,0,W,H);
            if(blurImg) ctx.drawImage(blurImg, 0,0,W,H);

            // Cover Art Circle
            if(coverImg) {
                const size = W < H ? 450 : 350;
                ctx.save();
                ctx.beginPath(); ctx.arc(W/2, H/3.5, size/2, 0, Math.PI*2); ctx.clip();
                ctx.drawImage(coverImg, W/2 - size/2, H/3.5 - size/2, size, size);
                ctx.restore();
            }

            // Text Info
            ctx.textAlign = 'center';
            ctx.fillStyle = 'white';
            ctx.font = "800 40px 'Plus Jakarta Sans'";
            ctx.fillText((songTitle.value || "JUDUL LAGU").toUpperCase(), W/2, H * 0.55);
            ctx.font = "600 24px 'Plus Jakarta Sans'";
            ctx.fillStyle = "rgba(255,255,255,0.6)";
            ctx.fillText((artistName.value || "ARTIS").toUpperCase(), W/2, H * 0.59);

            // Lyrics Logic
            const now = audio.currentTime;
            let activeIdx = -1;
            lyrics.forEach((l, i) => { if(now >= l.time) activeIdx = i; });

            if(lyrics.length > 0) {
                const centerY = H * 0.75;
                const spacing = 90;
                scrollY += (activeIdx * spacing - scrollY) * 0.1;

                lyrics.forEach((l, i) => {
                    const y = centerY + (i * spacing) - scrollY;
                    ctx.globalAlpha = Math.max(0, 1 - Math.abs(y - centerY)/400);
                    ctx.font = i === activeIdx ? "800 50px 'Plus Jakarta Sans'" : "700 34px 'Plus Jakarta Sans'";
                    ctx.fillStyle = i === activeIdx ? "#818cf8" : "rgba(255,255,255,0.2)";
                    ctx.fillText(l.text.toUpperCase(), W/2, y);
                });
                ctx.globalAlpha = 1;
            }
            if(audio.duration) document.getElementById('progressBar').style.width = (audio.currentTime/audio.duration)*100 + "%";
        }

        document.getElementById('audioFile').onchange = (e) => audio.src = URL.createObjectURL(e.target.files[0]);
        document.getElementById('coverFile').onchange = (e) => {
            const img = new Image(); img.onload = () => {
                coverImg = img;
                const t = document.createElement('canvas'); t.width = 160; t.height = 90;
                const tc = t.getContext('2d'); tc.filter = 'blur(10px) brightness(0.3)';
                tc.drawImage(img, 0, 0, 160, 90); blurImg = t;
                draw();
            };
            img.src = URL.createObjectURL(e.target.files[0]);
        };
        syncMap.oninput = () => {
            lyrics = syncMap.value.split('\n').map(line => {
                const m = line.match(/\[(\d+):(\d+\.\d+)\]\s*(.*)/);
                if (m) return { time: parseInt(m[1]) * 60 + parseFloat(m[2]), text: m[3].trim() };
                return null;
            }).filter(x => x).sort((a,b) => a.time - b.time);
        };
        playBtn.onclick = () => {
            if(audio.paused) { audio.play(); isPlaying = true; (function loop() { if(isPlaying){draw();requestAnimationFrame(loop);}})(); } 
            else { audio.pause(); isPlaying = false; }
        };
        exportBtn.onclick = () => {
            const stream = canvas.captureStream(30);
            const recorder = new MediaRecorder(stream, { mimeType: 'video/webm' });
            const chunks = [];
            document.getElementById('loadingOverlay').classList.remove('hidden');
            recorder.ondataavailable = e => chunks.push(e.data);
            recorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'video/webm' });
                const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'sontil-video.webm'; a.click();
                document.getElementById('loadingOverlay').classList.add('hidden');
            };
            audio.currentTime = 0; audio.play(); recorder.start();
            audio.onended = () => recorder.stop();
        };
        window.onload = () => setRatio("9:16");
    </script>
</body>
</html>
